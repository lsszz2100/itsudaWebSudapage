<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace ="itsuda.community">


<!-- <typeAlias type="com.itsuda.community.vo.CommunityVO" alias="CommunityVO"/> -->
<!--     	<typeAlias type="com.itsuda.community.vo.ReplyVO" alias="ReplyVO"/> -->


	<!-- 출력 -->
	<select id="list" resultType="com.itsuda.community.vo.ReplyVO">
	SELECT
		REPLY_NO
		,SEQ
		,REPLY_TEXT
		,REPLY_WRITER
		,date_format(REG_DATE, "%Y-%c-%e %r") AS REG_DATE
		,date_format(UPDATE_DATE, "%Y-%c-%e %r") AS UPDATE_DATE
	FROM
		TB_COMMUNITY_REPLY
	WHERE
		seq = #{seq}
	ORDER BY REPLY_NO DESC
	</select>

    <!--입력-->
    <insert id="create">
        INSERT INTO TB_COMMUNITY_REPLY (
            SEQ
            , REPLY_TEXT
            , REPLY_WRITER
        ) VALUES (
            #{seq}
            , #{replyText}
            , #{replyWriter}
        )
    </insert>
    

    <!--수정-->
    <update id="update">
        UPDATE 
        	TB_COMMUNITY_REPLY
        SET 
        	REPLY_TEXT = #{replyText}
        	,UPDATE_DATE = NOW()
        WHERE REPLY_NO = #{replyNo}
    </update>

    <!--삭제-->
    <delete id="delete">
        DELETE FROM 
        	TB_COMMUNITY_REPLY
        WHERE 
        	REPLY_NO = #{replyNo}
    </delete>
    
   
  
    
    <select id="listPaging" resultType="com.itsuda.community.vo.ReplyVO">
    	SELECT
    		REPLY_NO
			,SEQ
			,REPLY_TEXT
			,REPLY_WRITER
			,date_format(REG_DATE, "%Y-%c-%e %r") AS REG_DATE
			,date_format(UPDATE_DATE, "%Y-%c-%e %r") AS UPDATE_DATE
		FROM
			TB_COMMUNITY_REPLY
		WHERE
			seq = #{seq}
		ORDER BY REPLY_NO DESC
		LIMIT #{criteria.pageStart}, #{criteria.perPageNum}
    </select>
    
    <select id="countReplies" resultType="int">
    	SELECT
    		COUNT(SEQ)
    	FROM
    		TB_COMMUNITY_REPLY
    	WHERE
    		SEQ = #{seq}
    </select>
    
    
</mapper>